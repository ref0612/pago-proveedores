{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from 'react';\nimport { useAuth } from './useAuth';\n// Cambia esta URL por la de tu backend\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/api/productions/pendientes';\nexport function useValidacionApi() {\n  _s();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const {\n    user\n  } = useAuth();\n\n  // Obtener validaciones\n  const fetchValidaciones = async (decena, includeValidated = true) => {\n    setLoading(true);\n    setError(null);\n    try {\n      const url = decena ? `${API_URL}?decena=${decena}&includeValidated=${includeValidated}` : `${API_URL}?includeValidated=${includeValidated}`;\n      const res = await fetch(url);\n      if (!res.ok) throw new Error('Error al obtener validaciones');\n      return await res.json();\n    } catch (err) {\n      setError(err.message);\n      return [];\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Aprobar o rechazar validaci贸n (ahora acepta estatus)\n  const validar = async (id, estatus, comentarios) => {\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await fetch(`${API_URL}/${id}/validate`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-User-Email': (user === null || user === void 0 ? void 0 : user.email) || ''\n        },\n        body: JSON.stringify({\n          estatus,\n          comentarios\n        })\n      });\n      if (!res.ok) throw new Error('Error al validar producci贸n');\n      return true;\n    } catch (err) {\n      setError(err.message);\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  };\n  return {\n    fetchValidaciones,\n    validar,\n    loading,\n    error\n  };\n}\n\n/**\r\n * Ejemplo de uso:\r\n *\r\n * const { fetchValidaciones, validar, loading, error } = useValidacionApi();\r\n *\r\n * useEffect(() => { fetchValidaciones(); }, []);\r\n *\r\n * validar(id, true, 'Aprobado sin observaciones');\r\n */\n_s(useValidacionApi, \"iy0cIQQAcVBe6WCAvgiPg84XgKE=\", false, function () {\n  return [useAuth];\n});","map":{"version":3,"names":["useState","useAuth","API_URL","process","env","REACT_APP_API_URL","useValidacionApi","_s","loading","setLoading","error","setError","user","fetchValidaciones","decena","includeValidated","url","res","fetch","ok","Error","json","err","message","validar","id","estatus","comentarios","method","headers","email","body","JSON","stringify"],"sources":["C:/Users/pasaj/Music/pullman-payment-system/frontend/src/hooks/useValidacionApi.ts"],"sourcesContent":["import { useState } from 'react';\r\nimport { useAuth } from './useAuth';\r\n\r\nexport interface Validacion {\r\n  id?: number;\r\n  decena: string;\r\n  total: number;\r\n  validado: boolean;\r\n  comentarios: string;\r\n  entrepreneur: { nombre: string };\r\n}\r\n\r\n// Cambia esta URL por la de tu backend\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/api/productions/pendientes';\r\n\r\nexport function useValidacionApi() {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const { user } = useAuth();\r\n\r\n  // Obtener validaciones\r\n  const fetchValidaciones = async (decena?: string, includeValidated: boolean = true): Promise<Validacion[]> => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const url = decena ? `${API_URL}?decena=${decena}&includeValidated=${includeValidated}` : `${API_URL}?includeValidated=${includeValidated}`;\r\n      const res = await fetch(url);\r\n      if (!res.ok) throw new Error('Error al obtener validaciones');\r\n      return await res.json();\r\n    } catch (err: any) {\r\n      setError(err.message);\r\n      return [];\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Aprobar o rechazar validaci贸n (ahora acepta estatus)\r\n  const validar = async (id: number, estatus: string, comentarios: string): Promise<boolean> => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const res = await fetch(`${API_URL}/${id}/validate`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'X-User-Email': user?.email || '',\r\n        },\r\n        body: JSON.stringify({ estatus, comentarios }),\r\n      });\r\n      if (!res.ok) throw new Error('Error al validar producci贸n');\r\n      return true;\r\n    } catch (err: any) {\r\n      setError(err.message);\r\n      return false;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return {\r\n    fetchValidaciones,\r\n    validar,\r\n    loading,\r\n    error,\r\n  };\r\n}\r\n\r\n/**\r\n * Ejemplo de uso:\r\n *\r\n * const { fetchValidaciones, validar, loading, error } = useValidacionApi();\r\n *\r\n * useEffect(() => { fetchValidaciones(); }, []);\r\n *\r\n * validar(id, true, 'Aprobado sin observaciones');\r\n */ "],"mappings":";AAAA,SAASA,QAAQ,QAAQ,OAAO;AAChC,SAASC,OAAO,QAAQ,WAAW;AAWnC;AACA,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,kDAAkD;AAEnG,OAAO,SAASC,gBAAgBA,CAAA,EAAG;EAAAC,EAAA;EACjC,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGT,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACU,KAAK,EAAEC,QAAQ,CAAC,GAAGX,QAAQ,CAAgB,IAAI,CAAC;EACvD,MAAM;IAAEY;EAAK,CAAC,GAAGX,OAAO,CAAC,CAAC;;EAE1B;EACA,MAAMY,iBAAiB,GAAG,MAAAA,CAAOC,MAAe,EAAEC,gBAAyB,GAAG,IAAI,KAA4B;IAC5GN,UAAU,CAAC,IAAI,CAAC;IAChBE,QAAQ,CAAC,IAAI,CAAC;IACd,IAAI;MACF,MAAMK,GAAG,GAAGF,MAAM,GAAG,GAAGZ,OAAO,WAAWY,MAAM,qBAAqBC,gBAAgB,EAAE,GAAG,GAAGb,OAAO,qBAAqBa,gBAAgB,EAAE;MAC3I,MAAME,GAAG,GAAG,MAAMC,KAAK,CAACF,GAAG,CAAC;MAC5B,IAAI,CAACC,GAAG,CAACE,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,+BAA+B,CAAC;MAC7D,OAAO,MAAMH,GAAG,CAACI,IAAI,CAAC,CAAC;IACzB,CAAC,CAAC,OAAOC,GAAQ,EAAE;MACjBX,QAAQ,CAACW,GAAG,CAACC,OAAO,CAAC;MACrB,OAAO,EAAE;IACX,CAAC,SAAS;MACRd,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;;EAED;EACA,MAAMe,OAAO,GAAG,MAAAA,CAAOC,EAAU,EAAEC,OAAe,EAAEC,WAAmB,KAAuB;IAC5FlB,UAAU,CAAC,IAAI,CAAC;IAChBE,QAAQ,CAAC,IAAI,CAAC;IACd,IAAI;MACF,MAAMM,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGhB,OAAO,IAAIuB,EAAE,WAAW,EAAE;QACnDG,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClC,cAAc,EAAE,CAAAjB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEkB,KAAK,KAAI;QACjC,CAAC;QACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEP,OAAO;UAAEC;QAAY,CAAC;MAC/C,CAAC,CAAC;MACF,IAAI,CAACV,GAAG,CAACE,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,6BAA6B,CAAC;MAC3D,OAAO,IAAI;IACb,CAAC,CAAC,OAAOE,GAAQ,EAAE;MACjBX,QAAQ,CAACW,GAAG,CAACC,OAAO,CAAC;MACrB,OAAO,KAAK;IACd,CAAC,SAAS;MACRd,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAED,OAAO;IACLI,iBAAiB;IACjBW,OAAO;IACPhB,OAAO;IACPE;EACF,CAAC;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARAH,EAAA,CArDgBD,gBAAgB;EAAA,QAGbL,OAAO;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}